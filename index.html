<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medicine Reminder</title>
    <meta name="theme-color" content="#22b8cf">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="apple-touch-icon" href="app-icon-192.png">
</head>
<body>

    <!-- Header -->
    <header class="glass-header">
        <button id="menu-toggle" class="icon-button" aria-label="Menu">&#9776;</button>
        <h1>MedReminder</h1>
        <div style="width: 40px;"></div> <!-- Spacer -->
    </header>

    <!-- Sidebar Menu (Hidden by default) -->
    <nav id="sidebar-menu" class="glass-panel">
        <button id="menu-close" class="icon-button" aria-label="Close Menu">&times;</button>
        <ul>
            <li><a href="https://zunaidhosse.github.io/My-contact/" target="_blank" rel="noopener">1Ô∏è‚É£ Help Line</a></li>
            <li><a href="https://i.postimg.cc/cHL1S9Wv/qrcode-1.png" target="_blank" rel="noopener">2Ô∏è‚É£ Share App</a></li>
            <li><button id="export-data-btn">3Ô∏è‚É£ Export Data</button></li>
            <li><button id="import-data-btn">4Ô∏è‚É£ Import Data</button></li>
            <li><button id="app-info-btn">5Ô∏è‚É£ App Information</button></li>
            <li><button id="clear-all-data-btn" class="danger">6Ô∏è‚É£ Clear All Data</button></li>
        </ul>
        <input type="file" id="import-file-input" accept=".json" style="display: none;">
    </nav>

    <!-- Main Content Area -->
    <main id="app-container">
        <!-- Home Page -->
        <section id="home-page" class="page active">
            <div id="medicine-list">
                <!-- Medicine cards will be injected here by JS -->
            </div>
            <p id="empty-home-message" class="empty-message">No medicines added yet. Tap ‚ûï to add one.</p>
        </section>

        <!-- Notifications Page -->
        <section id="notifications-page" class="page">
            <div id="notification-list">
                <!-- Notification items will be injected here by JS -->
            </div>
            <p id="empty-notification-message" class="empty-message">No notifications found.</p>
        </section>
    </main>

    <!-- Bottom Navigation -->
    <nav id="bottom-nav" class="glass-footer">
        <button id="nav-home" class="nav-button active" aria-label="Home">üè†<span class="nav-label">Home</span></button>
        <button id="nav-add" class="nav-button add-button" aria-label="Add Medicine">‚ûï</button>
        <button id="nav-notifications" class="nav-button" aria-label="Notifications">üîî<span class="nav-label">Notifications</span></button>
    </nav>

    <!-- Modal Overlay -->
    <div id="modal-overlay" class="hidden"></div>

    <!-- Add/Edit Medicine Modal -->
    <div id="add-medicine-modal" class="modal glass-panel hidden">
        <form id="add-medicine-form">
            <h2 id="modal-title">Add New Medicine</h2>
            <input type="hidden" id="edit-med-id">
            
            <div class="form-group">
                <label for="med-name">Medicine Name</label>
                <input type="text" id="med-name" required>
            </div>

            <div class="form-group">
                <label>Time Slots</label>
                <div class="chip-group">
                    <input type="checkbox" id="slot-morning" data-slot="Sokal">
                    <label for="slot-morning">Sokal</label>
                    <input type="checkbox" id="slot-noon" data-slot="Dupur">
                    <label for="slot-noon">Dupur</label>
                    <input type="checkbox" id="slot-evening" data-slot="Bikal">
                    <label for="slot-evening">Bikal</label>
                    <input type="checkbox" id="slot-night" data-slot="Raat">
                    <label for="slot-night">Raat</label>
                </div>
            </div>

            <div class="form-group time-pickers">
                <div id="time-morning-group" class="time-picker-group hidden">
                    <label for="time-morning">Sokal:</label>
                    <input type="time" id="time-morning">
                </div>
                <div id="time-noon-group" class="time-picker-group hidden">
                    <label for="time-noon">Dupur:</label>
                    <input type="time" id="time-noon">
                </div>
                <div id="time-evening-group" class="time-picker-group hidden">
                    <label for="time-evening">Bikal:</label>
                    <input type="time" id="time-evening">
                </div>
                <div id="time-night-group" class="time-picker-group hidden">
                    <label for="time-night">Raat:</label>
                    <input type="time" id="time-night">
                </div>
            </div>

            <div class="form-group toggle-group">
                <label for="auto-set-times">Auto set times (8, 13, 18, 22)</label>
                <input type="checkbox" id="auto-set-times" class="toggle-switch">
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="start-date">Start Date</label>
                    <input type="date" id="start-date" required>
                </div>
                <div class="form-group">
                    <label for="duration">Duration (days)</label>
                    <input type="number" id="duration" min="1" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="total-pills">Total Pills</label>
                    <input type="number" id="total-pills" min="1" required>
                </div>
                <div class="form-group">
                    <label for="per-dose">Pills per Dose</label>
                    <input type="number" id="per-dose" value="1" min="1" required>
                </div>
            </div>

            <div class="modal-actions">
                <button type="button" id="modal-cancel-btn" class="btn btn-secondary">Cancel</button>
                <button type="submit" id="modal-ok-btn" class="btn btn-primary">Add Medicine</button>
            </div>
        </form>
    </div>

    <!-- PIN Modal -->
    <div id="pin-modal" class="modal glass-panel hidden">
        <h2>Confirm Action</h2>
        <p>To clear all data, please enter the 4-digit PIN '0000'. This action cannot be undone.</p>
        <div class="form-group">
            <label for="pin-input">Enter '0000'</label>
            <input type="password" id="pin-input" maxlength="4" inputmode="numeric" pattern="\d*">
        </div>
        <div class="modal-actions">
            <button type="button" id="pin-cancel-btn" class="btn btn-secondary">Cancel</button>
            <button type="button" id="pin-confirm-btn" class="btn btn-danger">Confirm Clear</button>
        </div>
    </div>

    <!-- App Info Modal -->
    <div id="info-modal" class="modal glass-panel hidden">
        <h2>App Information</h2>
        <p><strong>Medicine Reminder (Offline)</strong></p>
        <p>This app works 100% offline. All your data is stored securely on your device's localStorage.</p>
        <strong>How to use:</strong>
        <ol>
            <li>Tap ‚ûï to add a new medicine schedule.</li>
            <li>The Home screen shows upcoming doses.</li>
            <li>Tap 'Taken' when you take a dose.</li>
            <li>The app will notify you when it's time (even if closed).</li>
            <li>Use the menu (‚ò∞) to Export (backup) or Import your data.</li>
        </ol>
        <div class="modal-actions">
            <button type="button" id="info-close-btn" class="btn btn-primary">OK</button>
        </div>
    </div>

    <!-- Custom Install Prompt Modal -->
    <div id="install-prompt-modal" class="modal glass-panel hidden">
        <h2>Install App?</h2>
        <p>For the best experience, add this app to your Home Screen. It works completely offline!</p>
        <div class="modal-actions">
            <button type="button" id="install-cancel-btn" class="btn btn-secondary">Later</button>
            <button type="button" id="install-confirm-btn" class="btn btn-primary">Install</button>
        </div>
    </div>

    <!-- Options Modal -->
    <div id="options-modal" class="modal glass-panel hidden">
        <h2>Options</h2>
        <div class="modal-actions-vertical">
            <button id="options-edit-btn" class="btn btn-secondary">Edit</button>
            <button id="options-delete-btn" class="btn btn-danger">Delete</button>
            <button id="options-cancel-btn" class="btn btn-primary">Cancel</button>
        </div>
    </div>

    <!-- Snooze Modal -->
    <div id="snooze-modal" class="modal glass-panel hidden">
        <h2>Snooze</h2>
        <p>Snooze this reminder for:</p>
        <div class="modal-actions-vertical">
            <button class="btn btn-secondary snooze-option" data-minutes="5">5 Minutes</button>
            <button class="btn btn-secondary snooze-option" data-minutes="10">10 Minutes</button>
            <button class="btn btn-secondary snooze-option" data-minutes="30">30 Minutes</button>
            <button id="snooze-cancel-btn" class="btn btn-primary">Cancel</button>
        </div>
    </div>


    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful with scope: ', registration.scope);
                    })
                    .catch(error => {
                        console.log('ServiceWorker registration failed: ', error);
                    });
            });
        }
    </script>
    <script src="app.js"></script>
</body>
</html>

